function [Y,Xf,Af] = ahu1_dampers(X,~,~)
% 50 nodes, Levenberg-Marquardt, Neural Fitting, 65 % train, 20 %
% validation, 15 % test
% X = [vav1, vav2, Tz1act-Tz1sp, Tz2act-Tz2sp];
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 21-Jul-2023 11:41:18.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx4 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;-12.4896;-12.2629];
x1_step1.gain = [0.00210437810076825;0.0023083470348157;0.124584200231727;0.1277481827821];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1490969105437587316;7.6800865825121782393;-2.6637550050808838087;7.0964723887920619916;-0.98721204317750443913;-4.0258049336527657047;0.82379712400097326874;1.4063806340446949328;7.9001281304457684485;4.1248181272153709997;-1.0390213506302345969;0.11212070441856274161;-4.9599464110939548434;7.3629183008774861108;-1.2661835282904039257;-3.4260368488000358944;2.0501079312980268199;3.5382359539055858733;1.3185801338265885629;-2.676619974601448515;0.33193676578202785388;-1.9136799416969474397;0.89084573197116989629;3.4269285822377599793;4.1621368819446535881;-3.1426622673890802773;1.4305993648468668944;0.59869396854644685302;0.40364558358770846747;0.37396013066261979407;1.0286176641511277641;-0.22838436771978029571;-0.30657367121296674739;-3.1844386849148538232;4.5923486770615724595;-2.2313556095534261559;-4.5142499398573248115;-2.3802576278518019492;5.0949291383099692965;3.9940301796033153003;1.4110469528313751564;5.430461659599262525;-16.898404522582307408;-4.9084897903634194805;9.1500337142547998326;4.6016959391915106536;-6.0918473334754796866;-10.039225882775633991;3.8021091185973778792;4.02318597871500927];
IW1_1 = [0.68656300460828112442 1.6865784222267796721 -2.3590221980637271493 -1.3135545001844264323;0.7437758380742978126 -2.740233928618726722 -0.16740862480102847165 -9.3783407575310082649;-2.0467996290395187309 -2.1123984191272642263 0.34337584316036723342 -3.4470215020228742731;-2.4321487002197432759 -2.0168776716358247647 1.8674724538588700629 -8.5360236317206705792;3.5280035265947153889 -3.9081711592900072461 1.3305672654672540123 2.4488660675920455034;0.86405621371346885695 -2.6949880439217523964 -2.4102269390364354784 -1.2629488555509083003;-1.0712481796890551689 0.75024041740976243897 -0.31352171049033755734 1.1712177769001694827;2.1208415084944474138 -3.0857976209346587027 -4.2670728675831934851 -0.4891053821323750328;-1.1427360680524485392 0.72148763043020014418 -8.6210106180688335087 -3.5671713178980293257;-4.4631197912259326088 1.9794993089739227887 -2.705668228182385171 -2.7727660649867695852;2.3143968979587765666 0.19922215591893199793 1.6492134775672753211 0.61054031010341824892;-1.0739427634805140954 0.79277488323744571552 -2.990386922259405722 -1.3584789864241690882;1.6250850118112349918 7.6392546463584167782 -0.94770621545451305678 -4.1747055523884695205;-0.77236235268812059029 0.46281422377494535469 -8.5682778641259815799 -2.9944594412825416008;4.4271708373162086403 -1.7018303850926992382 2.3472417582380349366 -4.7777502423383548802;-2.6121486198157941594 3.0553445050259346871 0.90541440490033886501 3.1132949472345057274;0.74938120925826712249 -1.3535111656355962584 -4.4224065638094183228 -0.41020040711663025013;11.163500337572575205 -9.4857769262020674716 -0.89764030383204107544 -3.2450897109350753666;-4.7519224910852466692 0.087722366454630759658 -1.3076541002645956091 -2.1174849674642817199;-0.81527163017986570281 0.8741645231624285417 5.5324705834453897779 0.72553509861514164925;-2.4033700355483706979 1.1046003271470867801 -2.5777088598893076465 -1.8523406410597684779;3.0114431554743683606 -1.3230785610248205764 0.4418115666588659507 1.3448553932577909098;-3.8227883043401216234 3.9488428336103988947 -1.5139563064213792387 -2.5760907945509345929;3.4584744721459417249 -2.1539799994480146594 -0.073214399750796244071 -4.5225263892374316654;7.3852192192414154448 5.910541819193035451 2.2290609792385089882 -1.2353038441608945597;-1.1629668573202709414 0.27891136052257847755 6.1674998448055688982 0.76146731647561882728;-3.3791416697966578653 1.2640831577719247036 0.24149425315654257651 -0.66733474551898275262;3.0233602706721440789 -7.1208863936606761058 3.0805722961284565109 1.2207535949266097308;-0.39420472941955725377 0.33318835279951863892 -0.74567592766092649637 1.4316053159829034147;2.9285789272616069567 -4.0635582375677428146 1.140073773014140146 1.3631222390139212663;0.55238467872310137441 0.84892897650150245248 -3.1128194243421334342 0.25025124769010631542;-5.3369895899761781166 -1.8775225392084224918 -1.1943662779362185233 -0.86723201629454460537;3.9352786724877608648 -2.9948216151420985476 0.48921110628786668162 0.51722624099195368963;-5.7449830859276849182 0.81524977159086819967 1.5745948960396745075 4.2279232438743337141;-0.66738783289218317485 -5.5070646316636349127 -0.9182811448238114016 3.0457524814835901239;0.70114120127141033034 0.13080389388827151631 -3.2637706957728327417 -2.1651786390100120627;-5.1959016429455928687 -2.5512490128493729991 -4.1693604989967960606 -3.0108408021278094679;-3.743500896584036397 -0.094761896033678016948 -2.1271461182658364386 -1.6292979728934711137;-1.9266610654934146485 4.8928783701175913023 -1.5377608216229690097 -5.8941861620049067483;3.6375875494430105483 -1.6387091717329889118 -0.11333515487479862982 -5.4022041384239525286;1.0010985538216590207 1.3347568361134178883 0.85380860696816973654 0.060561251126705829828;2.4587717192651190601 -3.7339667842599966185 -1.0497668575653646972 -5.4330299865844438045;-2.0721429596357689995 0.76260870175151806993 7.7726932925536722507 16.67216961258479202;-2.4810881732315150927 -2.7541094335787210667 -2.374083743465241092 -1.0139932928204655749;5.7571306042561793959 -4.7601406284504852451 -3.692949558243291186 -9.0772106561373373523;3.5157307853642096873 1.5244717253151001124 -0.92973194894958266499 1.9486532251965176243;-0.92865151546795832171 -5.4732558628743914753 1.2127073491591915388 -2.1382178668403266641;-1.9425912409683856463 -3.3970471274364482106 11.677012270866397259 3.151844421222867787;3.3840835562012028248 3.3905219031567290777 -1.5319366234703060137 -1.1719748384734127722;4.8361168658277406962 0.19192818158151470076 0.029382005111854087726 0.21787332652162530455];

% Layer 2
b2 = [-0.11657673599829097844;-1.1012329381153256325];
LW2_1 = [-0.8486406167826880953 0.12073653686510329996 0.47590778110801063017 0.038602757487508895795 -0.10735237248777107499 0.12037613880140039802 0.37692310611128093667 0.15940619836358815853 -0.26171280938264590565 0.34418760727175656822 0.33641102721857457647 0.15034903179497272063 0.072621776743865926185 0.13647375677026110652 0.0061274672996804030456 -0.43849821755008677737 -0.41006190913281198585 0.096594656018221147775 -0.038723954454452425011 0.012917553273502951211 -0.050320393707022466334 0.21084599297224349002 -0.1850251473501643984 0.26841365203161404729 0.049942830143222080586 -0.14193363735868325115 -0.33245704155605892982 0.16432550041260648999 0.033169586357982262792 0.12617482344887762102 -0.14580915092032101232 0.22705493574128254863 -0.13281535886287409998 -0.02826376080157201251 -0.77779465804449143818 -0.058340083386574759228 -0.69709395692057674054 -0.49678893257951661777 -0.011263782120968344677 -0.60314765319940788491 -0.75041893205857324034 -0.53814233116592513628 -0.12092618032205312839 0.038283054282175120464 -0.3500724318868601026 -0.19256810611451355419 -0.22350909159617227129 -0.12428775091880225889 0.4081395616477422883 0.04154848289961514396;0.54494656806419494721 -1.5672794191205912107 -0.26923450614494209843 0.27957529596520419579 3.9386684741448441116 1.2083274765406750717 2.6100859358447801029 -0.46327644905880743798 2.0242038616704651766 0.5796682778839786776 1.3106721456033947337 1.1206539359475475859 1.7162509402842187622 -2.5882046343301174929 0.1149232431816998995 4.1396912029060795035 2.7486793965987210697 -0.3487518203890017654 0.82172192630856200068 2.8294780663535195053 -1.1783402502528661504 2.0590327298844295356 3.7141056385419140007 4.6754206736413816969 0.36610597606979999874 -1.3520104598757241021 1.5543620200525818387 -0.72957051345942935949 -2.5945789957229776768 1.393868526893513371 0.49967912986441787027 -0.59614125179492594153 -1.2030442134354402128 0.10898346060920033329 2.6875082704387467381 -0.32525381705181699576 -0.32696366539583154864 -0.82558762918013961496 -0.091821789691710037351 -2.6033231551321414088 -3.1091530792249146842 3.7190391051088051988 -0.28976000322315154101 -1.6010346869373406342 -0.77846547303617352753 -3.2238905442944689739 -2.4625339147649660809 -0.26597392834450950261 -0.50185329982696536 1.9514356812270416963];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.2;0.0004];
y1_step1.xoffset = [0;0];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
